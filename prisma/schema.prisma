generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

enum ProfileStatus {
  active
  retired
  deleted
}

model Profile {
  id              String         @id @default(uuid())
  userId          String         @unique @db.Uuid
  handle          String         @unique
  displayName     String
  avatarUrl       String?
  bio             String?
  iRating         Int?
  socials         Json?
  marketingOptIn  Boolean        @default(true)
  status          ProfileStatus  @default(active)

  eid             String?        @unique        // UT EID (or student ID); optional but unique when present
  gradYear        Int?                           // graduating year like 2026
  signedUpAt      DateTime       @default(now()) // timestamp when we first provision the profile

  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt
}

model Driver {
  id         String   @id @default(uuid()) @db.Uuid
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  fullName   String
  handle     String   @unique
  bio        String?  @db.Text
  headshotUrl String? // Cloudinary URL later
  instagram  String?  @unique
  twitch     String?  @unique
  iRating    Int?
  totalWins  Int      @default(0)

  @@index([handle])
}

enum SponsorTier {
  title
  gold
  silver
  bronze
}

model Sponsor {
  id         String      @id @default(uuid()) @db.Uuid
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt

  name       String      @unique
  url        String?
  logoUrl    String?     // Cloudinary URL later
  tier       SponsorTier @default(bronze)
}

model Event {
  id          String   @id @default(uuid()) @db.Uuid
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  title       String
  startAt     DateTime
  endAt       DateTime?
  location    String?
  description String?  @db.Text
  externalUrl String?
}
